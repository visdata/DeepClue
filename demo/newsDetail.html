<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
    <script type="text/javascript" src="js/jquery-2.1.4.js"></script>
    <script type="text/javascript">
        function getArgsFromHref(sHref, sArgName)
        {
            var args = sHref.split("?");
            var retval = "";
            if(args[0] == sHref) /*参数为空*/
            {
                return retval; /*无需做任何处理*/
            }
            var str = args[1];
            args = str.split("&");
            for(var i = 0; i < args.length; i ++)
            {
                str = args[i];
                var arg = str.split("=");
                if(arg.length <= 1) continue;
                if(arg[0] == sArgName)
                    retval = arg[1];
            }
            return retval;
        }

        var url = window.location.href; //获取当前页面的url
        var date = getArgsFromHref(url, "date");
        var title = getArgsFromHref(url, "title");
        var news_id = getArgsFromHref(url, 'news_id');
        console.log(news_id);
//        console.log(title);
//        title = title.replace(/%20/g, " ");

        var SERVER = "211.147.15.14";
        var PORT = 6693;
//        var url = "http://"+SERVER+":5000/getNewsContent/" + title;
//        var url = "http://"+SERVER+":"+PORT+"/getNewsContent?news_id=" + news_id;
        var url = "http://"+SERVER+":"+PORT+"/getNewsContent?news_id=" + news_id;

        console.log(url);

        $(document).ready(function(){
            $.ajax({
                url: url,
                context: document.body,
                async: false,   //同步
//                async: true,  //异步
                success: function(data){
                    data = eval("("+data+")");
                    var content = data['content'];
                    console.log(content);
                    var contents = content.split("\n");
                    title = contents[0].split("--")[1];
                    var author = contents[1].split("--")[1];
                    var news_url = contents[3].split("--")[1];
                    var news_content = contents.slice(4).join("\n").replace(/(^\s*)|(\s*$)/g, "");
                    console.log(news_url);
                    console.log(news_content);
        //            $("#detail").html($("#detail").html()+"<br><br>"+contents[4]);
                    $("#title").html("Title: " + title);
                    $("#author").html("Author: " + author);
                    $("#date").html("Date: " + date);
                    $("#url").html("Url: <a target='_blank' href='" + news_url + "'>" + news_url + "</a>");
                    $("#content").html("Content: " + news_content);
                },
                error: function(error) {
                    alert("news content error!");
                    console.log(error);
                }
            });
//            var htmlobj=$.ajax({url:url,async:false});
//            var data = eval("("+htmlobj.responseText+")");
//            var content = data['content'];
//            console.log(content);
//            var contents = content.split("\n");
//            title = contents[0].split("--")[1];
//            var author = contents[1].split("--")[1];
//            var news_url = contents[3].split("--")[1];
//            var news_content = contents.slice(4).join("\n").replace(/(^\s*)|(\s*$)/g, "");
//            console.log(news_url);
//            console.log(news_content);
////            $("#detail").html($("#detail").html()+"<br><br>"+contents[4]);
//            $("#title").html("Title: " + title);
//            $("#author").html("Author: " + author);
//            $("#date").html("Date: " + date);
//            $("#url").html("Url: <a target='_blank' href='" + news_url + "'>" + news_url + "</a>");
//            $("#content").html("Content: " + news_content);
        });

    </script>
</head>
<body>
<div id="detail">
    <center><span>News Content</span><br></center>
    <span id="title"></span><br>
    <span id="author"></span><br>
    <span id="date"></span><br>
    <span id="time"></span><br>
    <span id="url"></span><br>
    <span id="content"></span><br>
</div>
</body>
</html>